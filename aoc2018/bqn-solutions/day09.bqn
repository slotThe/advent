âŸ¨SplitâŸ© â† â€¢Import "../../util/bqn_util/util.bqn"
pâ€¿w â† âŸ¨âŠ‘,Â¯2âŠ¸âŠ‘âŸ©{â€¢ParseFloatğ•ğ•©}Â¨ <' 'Split â€¢FChars"../inputs/day09.txt"
xs â† âŸ¨1â€¿2,2â€¿0,0â€¿1âŸ©âˆ¾wâ¥Š0

Ins â† { kğ•Šj:
  Â·â€¿i   â† jâŠ‘xs
  ipâ€¿in â† iâŠ‘xs
  npâ€¿nn â† inâŠ‘xs
  xs âŸ¨iâ€¿in,ipâ€¿k,kâ€¿nnâŸ©âŒ¾(kâ€¿iâ€¿inâŠ¸âŠ)â†©
}

Del â† { ğ•Ši:
  pâ€¿n  â† iâŠ‘xs
  ppâ€¿Â· â† pâŠ‘xs
  Â·â€¿nn â† nâŠ‘xs
  xs âŸ¨Â¯1â€¿Â¯1,ppâ€¿n,pâ€¿nnâŸ©âŒ¾(iâ€¿pâ€¿nâŠ¸âŠ)â†©
}

Mov â† {
  ğ•Š0â€¿p: p;
  ğ•Šnâ€¿i: ğ•Š âŸ¨n+1, 0âŠ‘iâŠ‘xsâŸ©
}

Sol â† { ğ•ŠÂ·:
  âŒˆÂ´2âŠ‘{
    ğ•Š iâ€¿stâ€¿ps: 0=23|st?
      d â† Mov Â¯7â€¿i
      Â·â€¿n â† dâŠ‘xs
      xs Â¯1â€¿Â¯1âŒ¾((i+1)âŠ¸âŠ‘)â†©
      Del d
      ps (d+stâŠ¸+)âŒ¾((p|st-1)âŠ¸âŠ‘)â†©
      âŸ¨n, st+1, psâŸ©;
    ğ•Š iâ€¿stâ€¿ps:
      st Ins i
      Â·â€¿in  â† iâŠ‘xs
      Â·â€¿inn â† inâŠ‘xs
      âŸ¨inn, st+1, psâŸ©
  }â€¢_while_{
    ğ•Š iâ€¿stâ€¿ps: stâ‰¤w
  } âŸ¨2, 3, pâ¥Š0âŸ©
}

Sol@ # â‡’ 405143

w Ã—âŸœ100â†© â‹„ xs â†© âŸ¨1â€¿2,2â€¿0,0â€¿1âŸ©âˆ¾wâ¥Š0 â‹„ @
Sol@ # â‡’ 3411514667
