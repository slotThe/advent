âŸ¨Split,_FixâŸ© â† â€¢Import "../../util/bqn_util/util.bqn"
âŸ¨KnotHashâŸ© â† â€¢Import "./day10.bqn"

grid â† {
  HexToBin â† {  ğ•Šp: pğ•ŠâŸ¨âŸ©;              # Start
               0ğ•Šr: râˆ¾Ëœ0â¥ŠËœ4-â‰ r;        # End: pad with zeros
               pğ•Šr: (âŒŠpÃ·2)ğ•Š(râˆ¾Ëœ2|p)    # Conversion
             }Â¨âˆ˜("0123456789abcdef"âŠ¸âŠ) # Convert hex to decimal, then to binary
  Start â† (âŠ‘â€¢FLines"../inputs/day14.txt")âˆ¾"-"âˆ¾â€¢Fmt
  Row â† âˆ¾âˆ˜HexToBinâˆ˜KnotHash
  >Rowâˆ˜StartÂ¨â†•128
}

â€¢Show +Â´â¥Šgrid # â‡’ 8222

{ ğ•Šg:
  g (+`âŠ¸Ã—âŒ¾â¥Š)â†©                          # reshape with unique numbers for all 1's
  g {(Ã—ğ•©)Ã—âŒˆÂ´âŸ¨Â»Ë˜,Â«Ë˜,Â»,Â«,âŠ¢âŸ©{ğ•ğ•©}Â¨<ğ•©}_Fixâ†© # See [Note Game of Life]
  1-Ëœ+Â´âˆŠâ¥Šg                             # Count all unique numbers minus 0
} grid # â‡’ 1086

# [Note Game of Life]
#
# This is actually a pretty cool idea, sort of stolen from a game of life way
# of thinking. The idea is to compare a live cell with each of its four
# neighbours. Since every live cell is associated to a unique number, always
# take the biggest one. For example,
#
#     mâ†3â€¿3â¥Š0â€¿0â€¿2â€¿1â€¿3â€¿0â€¿4â€¿0â€¿0
# â”Œâ”€
# â•µ 0 0 2
#   1 3 0
#   4 0 0
#         â”˜
#    {(Ã—ğ•©)Ã—(Â»Ë˜ğ•©)âŒˆ(Â«Ë˜ğ•©)âŒˆ(Â»ğ•©)âŒˆ(Â«ğ•©)âŒˆğ•©}m
# â”Œâ”€
# â•µ 0 0 2
#   4 3 0
#   4 0 0
#         â”˜
# and the fixed point then does its thing.
