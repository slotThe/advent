âŸ¨Split,_Fix,crâŸ© â† â€¢Import"../../util/bqn_util/util.bqn"
inp â† â€¢ParseFloatÂ¨âˆ˜('/'âŠ¸Split)Â¨ â€¢FLines"../inputs/day24.txt"

SM â† Â¬âˆ˜âˆŠ/âŠ£ # Set minus

# Select all elements in ğ•© = âŸ¨âŸ¨xâ‚â‚, xâ‚â‚‚âŸ©, âŸ¨xâ‚‚, yâ‚‚âŸ©, â€¦âŸ©
# where one of the xáµ¢â‚‹'s matches ğ•¨.
Sel â† (>âˆŠÂ¨)/âŠ¢

F â† { t Rec xs: # Target value t, list xs
  {(+Â´ğ•©) {rğ•ŠâŸ¨âŸ©: r; ğ•¨+âŒˆÂ´ğ•©} (ğ•©âŠ‘Ëœt=âŠ‘ğ•©) Rec xs SM âŸ¨ğ•©âŸ©}Â¨t Sel xs
}
âŒˆÂ´âˆ¾{ğ•Š0â€¿b: b+ b F inp SM âŸ¨0â€¿b,bâ€¿0âŸ©}âˆ˜âˆ§Â¨0 Sel inp # â‡’ 1656

MF â† âŒˆÂ´âˆ˜(âŒˆÂ´âŠ¸=âˆ˜(âŠ‘Â¨)âŠ¸/) # Max by the first element, with second element as tiebreaker.
F2 â† { iâ€¿t Rec xs: # Step i, target value t, list xs
  {(+Â´ğ•©) {rğ•ŠâŸ¨âŸ©: âŸ¨i,râŸ©; 0â€¿ğ•¨+MFğ•©} âŸ¨i+1, ğ•©âŠ‘Ëœt=âŠ‘ğ•©âŸ© Rec xs SM âŸ¨ğ•©âŸ©}Â¨t Sel xs
}
âŒˆÂ´âˆ¾{ğ•Š0â€¿b: 0â€¿bâŠ¸+Â¨ 1â€¿b F2 inp SM âŸ¨0â€¿b,bâ€¿0âŸ©}âˆ˜âˆ§Â¨0 Sel inp # â‡’ âŸ¨ 30 1642 âŸ©
