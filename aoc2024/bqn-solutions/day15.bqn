âŸ¨SplitFâŸ© â† â€¢Import "../../util/bqn_util/util.bqn"
IxOf â† /â—‹â¥ŠâŸœâ†•âŸœâ‰¢       # Index of all 1's in array ð•©
Start â† {âŠ‘IxOf'@'=ð•©}

insâ€¿mvs â† {
  insâ€¿mvs â† âŸ¨âŸ©SplitF â€¢FLines"../inputs/day15.txt"
  âŸ¨>ins, (âŸ¨'^','>','v','<'âŸ©âŠâˆ¾mvs)âŠâŸ¨Â¯1â€¿0,0â€¿1,1â€¿0,0â€¿Â¯1âŸ©âŸ©
}

Sim â† { ð•Šgridâ€¿posâ€¿dirs:
  { ð•ŠâŸ¨âŸ©â€¿âŸ¨âŸ©â€¿ds:   âŸ¨Start gridâŸ©â€¿âŸ¨âŸ©â€¿(1â†“ds);          # hit wall
    ð•ŠâŸ¨âŸ©â€¿seenâ€¿ds:                                  # can move stuff
      {grid'.'âŒ¾((âŠ‘ð•©)âŠ¸âŠ‘)â†©}Â¨ksâ†(âŠ£â‹ˆâŠ‘âŸœgrid)Â¨seen
      {ð•Špâ€¿v: grid vâŒ¾((p+âŠ‘ds)âŠ¸âŠ‘)â†©}Â¨ks
      âŸ¨Start gridâŸ©â€¿âŸ¨âŸ©â€¿(1â†“ds);
    ð•Špsâ€¿seenâ€¿ds: âŠ‘(<âŠ‘ps)âˆŠseen? âŸ¨1â†“ps, seen, dsâŸ©;  # already collected
    ð•Špsâ€¿seenâ€¿ds:                                  # explore new position
      { ð•Š'#': âŸ¨âŸ¨âŸ©,                 âŸ¨âŸ©,      dsâŸ©;
        ð•Š'.': âŸ¨1â†“ps,               seenâˆ¾<p, dsâŸ©;
        ð•Š'O': âŸ¨(<np)        âˆ¾1â†“ps, seenâˆ¾<p, dsâŸ©;
        ð•Š'[': âŸ¨âŸ¨np+0â€¿1 , npâŸ©âˆ¾1â†“ps, seenâˆ¾<p, dsâŸ©;
        ð•Š']': âŸ¨âŸ¨np+0â€¿Â¯1, npâŸ©âˆ¾1â†“ps, seenâˆ¾<p, dsâŸ©
      }gridâŠ‘Ëœ npâ† (âŠ‘ds)+ pâ†âŠ‘ps
  }â€¢_while_{ ð•ŠÂ·â€¿Â·â€¿ds: âŸ¨âŸ©â‰¢ds } âŸ¨posâŸ©â€¿âŸ¨âŸ©â€¿dirs
  grid                                            # return the finished grid
}
Solve â† { +Â´{ð•Šyâ€¿x: x+yÃ—100}Â¨ IxOfâˆŠâŸœ'O'â€¿'[' SimâŸ¨ð•©, Start ð•©, mvsâŸ© }

!1552463â‰¡Solve ins
!1554058â‰¡Solve (âˆ¾{ð•Š'#':"##"; ð•Š'O':"[]"; ð•Š'.':".."; ð•Š'@':"@."}Â¨)Ë˜ins
