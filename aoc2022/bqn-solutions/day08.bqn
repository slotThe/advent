inp â† >(-âŸœ'0')Â¨ â€¢FLines "../inputs/day8.txt"
Select â† { xâ€¿y:        # There must be a better way, right?
  âŸ¨ âŸ¨ â‹ˆâŸœy, (x+1)âŠ¸â†“ âŸ©
    âŸ¨ â‹ˆâŸœy, âŒ½(xâŠ¸â†‘)  âŸ©
    âŸ¨ xâŠ¸â‹ˆ, (y+1)âŠ¸â†“ âŸ©
    âŸ¨ xâŠ¸â‹ˆ, âŒ½(yâŠ¸â†‘)  âŸ© âŸ©
}

IsVisible â† { arr ğ•Š pt:
  âˆ¨Â´ { fâ€¿g: âˆ§Â´(<âŸœ(ptâŠ‘arr))âˆ˜(âŠ‘âŸœarr)âˆ˜FÂ¨ G â†•â‰ arr }Â¨ Select pt
}
â€¢Show +Â´â¥Š { (ğ•©âŠ¸IsVisible)Â¨ â†•(â‰ ğ•©)â€¿(â‰ ğ•©) } inp

ViewingDistance â† { arr ğ•Š pt:
  Sol â† { fâ€¿g:
    # The first 0 marks the last tree we can see
    a â† <âŸœ(ptâŠ‘arr)âˆ˜âŠ‘âŸœarrâˆ˜FÂ¨ G â†•â‰ arr
    # If we take n things from an integer vector of length n-1, the
    # resulting vector will have length n, padded with zero. Thus, we
    # have to make sure that we didn't take "too much". This is how one
    # differentiates the case âŸ¨ 1 âŸ© from the case âŸ¨ 1 0 âŸ©.
    b â† (1+ aâŠ0)â†‘a
    (â‰ b) âŒŠ â‰ a
  }
  Ã—Â´ SolÂ¨ Select pt
}
â€¢Show âŒˆÂ´â¥Š { (ğ•©âŠ¸ViewingDistance)Â¨ â†•(â‰ ğ•©)â€¿(â‰ ğ•©) } inp
