âŸ¨IntsâŸ©â†â€¢Import"../../util/bqn_util/util.bqn"
inp â† IntsÂ¨ â€¢FLines "../inputs/day08.txt" â‹„ Dâ†{âŸ¨+Â´Ã—Ëœ(âŠ‘ğ•¨)-âŠ‘ğ•©, ğ•¨, ğ•©âŸ©}

set â† â†•â‰ inp # The simplest disjoint set implementation possible
R â† { ğ•©=(ğ•©âŠ‘set)? ğ•©; ğ•Šğ•©âŠ‘set } # Representative of a cycle
U â† { {ğ•Šaâ€¿b: aâ‰ b? set aâŒ¾(bâŠ¸âŠ‘)â†© â‹„ 1; 0} RÂ¨ğ•© } # Union of two cycles

il â† 1âŠ¸âŠ‘Â¨âˆ˜(1âŠ¸â†“)Â¨ âˆ§ (<âŒœËœâ†•â‰ inp) /â—‹â¥Š (DâŒœËœ â‹ˆÂ¨âŸœ(â†•âˆ˜â‰ ) inp) # input list
UÂ¨1000â†‘il â‹„ !97384= Ã—Â´3â†‘âˆ¨/â¼âŠRÂ¨set

# ğ•© is the number of disjoint cycles; resume from p1.
kâ†1000 â‹„ {U kâŠ‘il? ğ•©-1; ğ•©}â€¢_while_{k+â†©1 â‹„ ğ•©â‰¥2} (+Â´âˆŠâŠRÂ¨set)
!9003685096= Ã—Â´âŠ‘Â¨inpâŠËœilâŠ‘Ëœk-1
